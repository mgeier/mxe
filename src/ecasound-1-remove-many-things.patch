This file is part of MXE. See LICENSE.md for licensing information.

Contains ad hoc patches for cross building.

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 11:51:09 +0200
Subject: [PATCH 1/9] don't check poll.h


diff --git a/configure.ac b/configure.ac
index 1111111..2222222 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1211,7 +1211,7 @@ dnl Checks for system header files.
 dnl ---
 AC_HEADER_TIME
 dnl Note! Header filenames must be on the same line!
-AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/poll.h sys/stat.h sys/socket.h sys/time.h sys/types.h sys/wait.h sys/select.h,,
+AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/socket.h sys/time.h sys/types.h sys/wait.h sys/select.h,,
 		 AC_MSG_ERROR([*** not all required header files were found ***]))
 AC_CHECK_HEADERS(execinfo.h features.h inttypes.h locale.h ladspa.h sched.h stdint.h sys/mman.h termios.h)
 

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 11:53:13 +0200
Subject: [PATCH 2/9] don't check socket.h


diff --git a/configure.ac b/configure.ac
index 1111111..2222222 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1211,7 +1211,7 @@ dnl Checks for system header files.
 dnl ---
 AC_HEADER_TIME
 dnl Note! Header filenames must be on the same line!
-AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/socket.h sys/time.h sys/types.h sys/wait.h sys/select.h,,
+AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/time.h sys/types.h sys/wait.h sys/select.h,,
 		 AC_MSG_ERROR([*** not all required header files were found ***]))
 AC_CHECK_HEADERS(execinfo.h features.h inttypes.h locale.h ladspa.h sched.h stdint.h sys/mman.h termios.h)
 

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 11:54:48 +0200
Subject: [PATCH 3/9] don't check sys/wait.h


diff --git a/configure.ac b/configure.ac
index 1111111..2222222 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1211,7 +1211,7 @@ dnl Checks for system header files.
 dnl ---
 AC_HEADER_TIME
 dnl Note! Header filenames must be on the same line!
-AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/time.h sys/types.h sys/wait.h sys/select.h,,
+AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/time.h sys/types.h sys/select.h,,
 		 AC_MSG_ERROR([*** not all required header files were found ***]))
 AC_CHECK_HEADERS(execinfo.h features.h inttypes.h locale.h ladspa.h sched.h stdint.h sys/mman.h termios.h)
 

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 11:55:33 +0200
Subject: [PATCH 4/9] select.h


diff --git a/configure.ac b/configure.ac
index 1111111..2222222 100644
--- a/configure.ac
+++ b/configure.ac
@@ -1211,7 +1211,7 @@ dnl Checks for system header files.
 dnl ---
 AC_HEADER_TIME
 dnl Note! Header filenames must be on the same line!
-AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/time.h sys/types.h sys/select.h,,
+AC_CHECK_HEADERS(dlfcn.h errno.h fcntl.h regex.h signal.h unistd.h sys/stat.h sys/time.h sys/types.h,,
 		 AC_MSG_ERROR([*** not all required header files were found ***]))
 AC_CHECK_HEADERS(execinfo.h features.h inttypes.h locale.h ladspa.h sched.h stdint.h sys/mman.h termios.h)
 

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 12:04:54 +0200
Subject: [PATCH 5/9] fd io


diff --git a/kvutils/Makefile.am b/kvutils/Makefile.am
index 1111111..2222222 100644
--- a/kvutils/Makefile.am
+++ b/kvutils/Makefile.am
@@ -24,7 +24,6 @@ AM_CPPFLAGS = $(ECA_S_EXTRA_CPPFLAGS)
 kvutil_sources = 	kvu_dbc.cpp \
 			kvu_debug.cpp \
 			kvu_com_line.cpp \
-			kvu_fd_io.cpp \
 			kvu_locks.cpp \
 			kvu_message_item.cpp \
 			kvu_numtostr.cpp \
@@ -40,7 +39,6 @@ kvutil_headers = 	kvu_dbc.h \
 			kvu_debug.h \
 			kvu_definition_by_contract.h \
 			kvu_com_line.h \
-			kvu_fd_io.h \
 			kvu_inttypes.h \
 			kvu_locks.h \
 			kvu_message_item.h \

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 12:08:51 +0200
Subject: [PATCH 6/9] remove kvu_temporary_file_directory


diff --git a/kvutils/Makefile.am b/kvutils/Makefile.am
index 1111111..2222222 100644
--- a/kvutils/Makefile.am
+++ b/kvutils/Makefile.am
@@ -29,7 +29,6 @@ kvutil_sources = 	kvu_dbc.cpp \
 			kvu_numtostr.cpp \
 			kvu_procedure_timer.cpp \
 			kvu_rtcaps.cpp \
-			kvu_temporary_file_directory.cpp \
 			kvu_threads.cpp \
 			kvu_utils.cpp \
 			kvu_timestamp.cpp \
@@ -47,7 +46,6 @@ kvutil_headers = 	kvu_dbc.h \
 			kvu_object_queue.h \
 			kvu_procedure_timer.h \
 			kvu_rtcaps.h \
-			kvu_temporary_file_directory.h \
 			kvu_threads.h \
 			kvu_utils.h \
 			kvu_timestamp.h \

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 12:13:47 +0200
Subject: [PATCH 7/9] remove audioio


diff --git a/libecasound/Makefile.am b/libecasound/Makefile.am
index 1111111..2222222 100644
--- a/libecasound/Makefile.am
+++ b/libecasound/Makefile.am
@@ -84,43 +84,6 @@ ecasound_preset_include = \
 			file-preset.h \
 			global-preset.h
 
-ecasound_audioio_include = 	\
-			audioio.h \
-			audioio-buffered.h \
-			audioio-device.h \
-			audioio-plugin.h \
-			audioio-manager.h \
-			audioio-cdr.h \
-			audioio-cdr_impl.h \
-			audioio-ewf.h \
-			audioio-mp3.h \
-			audioio-mp3_impl.h \
-			audioio-ogg.h \
-			audioio-wave.h \
-			audioio-raw.h \
-			audioio-oss.h \
-			audioio-oss_impl.h \
-			audioio-null.h \
-			audioio-rtnull.h \
-			audioio-mikmod.h \
-			audioio-loop.h \
-			audioio-forked-stream.h \
-			audioio-timidity.h \
-			audioio-db-server.h \
-			audioio-db-server_impl.h \
-			audioio-db-buffer.h \
-			audioio-db-client.h \
-			audioio-proxy.h \
-			audioio-typeselect.h \
-			audioio-resample.h \
-			audioio-reverse.h \
-			audioio-flac.h \
-			audioio-aac.h \
-			audioio-tone.h \
-			audioio-seqbase.h \
-			audioio-acseq.h \
-			audioio-barrier.h
-
 ecasound_midi_include =	\
 			midi-server.h \
 			midi-client.h \
@@ -202,8 +165,6 @@ ecasound_test_framework_include = \
 			eca-test-repository.h \
 			eca-test-case.h \
 			audiofx_amplitude_test.h \
-			audioio_test.h \
-			audioio-device_test.h \
 			eca-audio-time_test.h \
 			eca-chainsetup_test.h \
 			eca-chainsetup-parser_test.h \
@@ -218,7 +179,6 @@ ecasound_test_framework_include = \
 #       uninstall-data targets
 noinst_HEADERS = 	$(ecasound_audiofx_include) \
 			$(ecasound_preset_include) \
-			$(ecasound_audioio_include) \
 			$(ecasound_midi_include) \
 		 	$(ecasound_controller_include) \
 			$(ecasound_general_include) \
@@ -250,40 +210,6 @@ ecasound_preset_src =  	global-preset.cpp \
 			preset.cpp \
 			file-preset.cpp
 
-ecasound_audioio1_src = audioio-cdr.cpp \
-			audioio-ewf.cpp \
-			audioio-mp3.cpp \
-			audioio-ogg.cpp \
-			audioio-wave.cpp \
-			audioio.cpp \
-			audioio-buffered.cpp \
-			audioio-device.cpp \
-			audioio-null.cpp \
-			audioio-raw.cpp \
-			audioio-mikmod.cpp \
-			audioio-rtnull.cpp \
-			audioio-loop.cpp \
-			audioio-forked-stream.cpp \
-			audioio-timidity.cpp \
-			audioio-db-server.cpp \
-			audioio-db-buffer.cpp \
-			audioio-db-client.cpp \
-			audioio-typeselect.cpp \
-			audioio-resample.cpp \
-			audioio-reverse.cpp \
-			audioio-proxy.cpp \
-			audioio-flac.cpp \
-			audioio-aac.cpp \
-			audioio-tone.cpp \
-			audioio-seqbase.cpp \
-			audioio-acseq.cpp
-
-if ECA_AM_COMPILE_OSS
-ecasound_audioio2_src = audioio-oss.cpp
-else
-ecasound_audioio2_src = 
-endif
-
 if ECA_AM_COMPILE_JACK
 jack_connections_src =  jack-connections.cpp
 else
@@ -347,8 +273,7 @@ ecasound_general_src = 	eca-chain.cpp \
 			eca-object-map.cpp \
 			eca-preset-map.cpp
 
-ecasound_common1_src = 	$(ecasound_audioio1_src) \
-			$(ecasound_audioio2_src) \
+ecasound_common1_src = \
 			$(jack_connections_src) \
 			$(ecasound_midi_src) \
 			$(ecasound_general_src)
@@ -389,7 +314,6 @@ install-data-local:
 	$(INSTALL_DATA) \
 		$(ecasound_audiofx_include) \
 		$(ecasound_preset_include) \
-		$(ecasound_audioio_include) \
 		$(ecasound_controller_include) \
 		$(ecasound_midi_include) \
 		$(ecasound_general_include) \
@@ -403,7 +327,6 @@ uninstall-local:
 	cd $(DESTDIR)$(includedir)/libecasound && \
 	rm -f   $(ecasound_audiofx_include) \
 		$(ecasound_preset_include) \
-		$(ecasound_audioio_include) \
 		$(ecasound_controller_include) \
 		$(ecasound_midi_include) \
 		$(ecasound_general_include)

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 12:15:49 +0200
Subject: [PATCH 8/9] remove midi-server


diff --git a/libecasound/Makefile.am b/libecasound/Makefile.am
index 1111111..2222222 100644
--- a/libecasound/Makefile.am
+++ b/libecasound/Makefile.am
@@ -85,7 +85,6 @@ ecasound_preset_include = \
 			global-preset.h
 
 ecasound_midi_include =	\
-			midi-server.h \
 			midi-client.h \
 			midi-parser.h \
 			midiio.h \
@@ -217,7 +216,6 @@ jack_connections_src =
 endif
 
 ecasound_midi_src =	\
-			midi-server.cpp \
 			midi-client.cpp \
 			midi-parser.cpp \
 			midiio.cpp \

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Matthias Geier <Matthias.Geier@gmail.com>
Date: Sun, 9 May 2021 12:17:50 +0200
Subject: [PATCH 9/9] remove everything midi


diff --git a/libecasound/Makefile.am b/libecasound/Makefile.am
index 1111111..2222222 100644
--- a/libecasound/Makefile.am
+++ b/libecasound/Makefile.am
@@ -84,16 +84,8 @@ ecasound_preset_include = \
 			file-preset.h \
 			global-preset.h
 
-ecasound_midi_include =	\
-			midi-client.h \
-			midi-parser.h \
-			midiio.h \
-			midiio-raw.h \
-			midiio-aseq.h
-
 ecasound_controller_include = \
 			ctrl-source.h \
-			midi-cc.h \
 			oscillator.h \
 			osc-gen.h \
 			osc-gen-file.h \
@@ -178,7 +170,6 @@ ecasound_test_framework_include = \
 #       uninstall-data targets
 noinst_HEADERS = 	$(ecasound_audiofx_include) \
 			$(ecasound_preset_include) \
-			$(ecasound_midi_include) \
 		 	$(ecasound_controller_include) \
 			$(ecasound_general_include) \
 			$(ecasound_extra_include) \
@@ -215,15 +206,7 @@ else
 jack_connections_src =  
 endif
 
-ecasound_midi_src =	\
-			midi-client.cpp \
-			midi-parser.cpp \
-			midiio.cpp \
-			midiio-raw.cpp \
-			midiio-aseq.cpp
-
 ecasound_controller_src = \
-			midi-cc.cpp \
 			osc-gen.cpp \
 			osc-gen-file.cpp \
 			osc-sine.cpp \
@@ -273,7 +256,6 @@ ecasound_general_src = 	eca-chain.cpp \
 
 ecasound_common1_src = \
 			$(jack_connections_src) \
-			$(ecasound_midi_src) \
 			$(ecasound_general_src)
 
 if ECA_AM_DISABLE_EFFECTS
@@ -313,7 +295,6 @@ install-data-local:
 		$(ecasound_audiofx_include) \
 		$(ecasound_preset_include) \
 		$(ecasound_controller_include) \
-		$(ecasound_midi_include) \
 		$(ecasound_general_include) \
 		$(DESTDIR)$(includedir)/libecasound
 	$(INSTALL) -d $(DESTDIR)$(bindir)
@@ -326,7 +307,6 @@ uninstall-local:
 	rm -f   $(ecasound_audiofx_include) \
 		$(ecasound_preset_include) \
 		$(ecasound_controller_include) \
-		$(ecasound_midi_include) \
 		$(ecasound_general_include)
 	rmdir $(DESTDIR)$(includedir)/libecasound || echo "Skipping"
 	rm -f 	$(DESTDIR)$(bindir)/libecasound-config
